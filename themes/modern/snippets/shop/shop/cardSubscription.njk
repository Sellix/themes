{% set id = uid() %}
{% set product = args.product %}
{% set isPlaceholder = not product.image_name %}
{% set image = cdn_link(product.cloudflare_image_id, 'shopItem') %}
{% set onHold = product.on_hold | int %}
{% set colors = themeProperties.current_colors %}
{% set cardProps = themeProperties.cards %}
{% set properties = args.properties %}

{% set showBadge = safe_get(properties.show_product_type_badge, true) %}
{% set background = safe_get(properties.background_color, cardProps.product_card_background_color) %}
{% set border = '1px solid var(--borderColor)' if safe_get(properties.show_border, cardProps.product_card_show_border) else 'none' %}
{% set borderRadius = safe_get(properties.border_radius, cardProps.product_card_border_radius) %}
{% set shadow = safe_get(properties.shadow, cardProps.product_card_shadow) %}
{% set imageBorderRadius = safe_get(properties.image_border_radius, cardProps.product_card_image_border_radius) %}
{% set imageHeight = safe_get(properties.image_height, cardProps.product_card_image_height) %}
{% set infoPaddingHoriz = safe_get(properties.info_padding_horiz, cardProps.product_card_info_padding_horiz) %}
{% set infoPaddingVert = safe_get(properties.info_padding_vert, cardProps.product_card_info_padding_vert) %}

{% set titleFontcolor = safe_get(properties.title_font_color, cardProps.product_card_title_font_color) %}
{% set titleFontSize = safe_get(properties.title_font_size, cardProps.product_card_title_font_size) %}
{% set titleFontWeight = safe_get(properties.title_font_weight, cardProps.product_card_title_font_weight) %}
{% set titleLineHeight = safe_get(properties.title_line_height, cardProps.product_card_title_line_height) %}
{% set titleTextAlign = safe_get(properties.title_text_align, cardProps.product_card_title_text_align) %}

{% set descriptionFontColor = safe_get(properties.description_font_color, cardProps.product_card_description_font_color) %}
{% set descriptionFontSize = safe_get(properties.description_font_size, cardProps.product_card_description_font_size) %}
{% set descriptionFontWeight = safe_get(properties.description_font_weight, cardProps.product_card_description_font_weight) %}

{% set priceFontColor = safe_get(properties.price_font_color, cardProps.product_card_price_font_color) %}
{% set priceFontSize = safe_get(properties.price_font_size, cardProps.product_card_price_font_size) %}
{% set priceFontWeight = safe_get(properties.price_font_weight, cardProps.product_card_price_font_weight) %}

{% set globalClass =  'snippet-product-card' %}
{% set localClass = id %}

<style>
  .{{ localClass }}__container {
    border: {{ border }};
    border-radius: {{ borderRadius }}px;
    box-shadow: {{ shadow }};
  }
  .{{ localClass }}__card {
    background: {{ colors[background] }};
  }
  .{{ localClass }}__title {
    color: {{ colors[titleFontcolor] }};
    font-size: {{ titleFontSize }}px;
    font-weight: {{ titleFontWeight }};
    line-height: {{ titleLineHeight }}px;
    justify-content: {{ titleTextAlign }};
  }
  .{{ localClass }}__info {
    padding: {{ infoPaddingVert }}px {{ infoPaddingHoriz }}px;
  }
  .{{ localClass }}__description {
    color: {{ colors[descriptionFontColor] }};
    font-size: {{ descriptionFontSize }}px;
    font-weight: {{ descriptionFontWeight }};
  }
  .{{ localClass }}__price {
    color: {{ colors[priceFontColor] }};
    font-size: {{ priceFontSize }}px;
    font-weight: {{ priceFontWeight }};
  }
  .{{ localClass }}__image {
    min-height: {{ imageHeight }}px;
    height: {{ imageHeight }}px;
  }
  .{{ localClass }}__image, .{{ localClass }}__image img {
    border-radius: {{ imageBorderRadius }}px;
    border-top-left-radius: {{ imageBorderRadius or borderRadius }}px;
    border-top-right-radius: {{ imageBorderRadius or borderRadius }}px;
  }
</style>

<div class="{{ globalClass }} d-flex w-100 position-relative">
  <a
    href="{{'javascript:void(0)' if onHold else ['product/', product.uniqid] | join}}"
    id="sellix-card-container-{{id}}"
    class="{{ globalClass }}__container {{ localClass }}__container"
  >
    <div class="{{ globalClass}}__card {{ localClass }}__card unselectable">
      {% if showBadge or onHold %}
        <div class="{{ globalClass }}__badge-container">
          {% if onHold %}
            <div class="{{ globalClass }}__badge icon-badge" style="margin-right: {{ '0.5rem' if showBadge else '0' }}">
              {% render_snippet 'Icons: Hand' %}
            </div>
          {% endif %}

          {% if showBadge %}
            <div class="{{ globalClass }}__badge {{ 'icon-badge' if onHold }}">
              {{ 'shop.shared.titles.productType.subscription' | t }}
            </div>
          {% endif %}
        </div>
      {% endif %}

      <div class="{{ globalClass }}__image {{ localClass }}__image {{'image-placeholder' if isPlaceholder else ''}}">
        {% if isPlaceholder %}
          {% render_snippet 'Product: Placeholder icon', product=product %}
        {% else %}
          <img src="{{image}}" alt="{{title}}" loading="lazy" />
        {% endif %}
      </div>

      <div class="{{ globalClass }}__info {{ localClass }}__info">
        <div class="{{ globalClass }}__description {{ localClass }}__description">
          <div class="{{ globalClass }}__group-description-info">
            <span class="{{ globalClass }}__stock">
              {{ 'shop.shared.titles.startingAt' | t }}
            </span>
            <span class="{{ localClass }}__price">
              {% render_snippet 'Price', currency=product.currency, price=product.price_display %}
            </span>
          </div>
        </div>

        <div class="{{ globalClass }}__title {{ localClass }}__title">
          {{product.title}}
        </div>

        {% if onHold %}
          <span class="{{ globalClass }}__info-comment {{ localClass }}__info-comment">
            {{ 'shop.main.cards.subscription.onHold' | t }}
          </span>
        {% endif %}
      </div>
    </div>
  </a>
</div>
