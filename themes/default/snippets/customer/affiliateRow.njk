{% set id = uid() %}
{% set product = args.product %}
{% set isPayWhatYouWant = (product.pay_what_you_want | int === 1) %}
{% set colors = themeProperties.current_colors %}
{% set cardsProps = themeProperties.cards %}
{% set shopAffiliateRevenue = global.common.shopInfo.shop.affiliate_revenue_percent %}
{% set productAffiliateRevenue = args.product.affiliate_revenue_percent %}
{% set isSubscription = args.isSubscription %}
{% set customerRefferalID = global.common.customerInfo.customer.id %}
{% set host = global.common.shopInfo.shop.isCustomDomain %}
{% set isPlaceholder = not product.image_name %}
{% set image = cdn_link(product.cloudflare_image_id, 'shopItem') %}


<tr class="sellix-customer-table-item">
  <td style="width: 60%;">
      <div class="d-flex align-items-center justify-content-between">
          <div class="sellix-customer-table-product">
              <div class="sellix-customer-table-product-image {{'placeholder' if isPlaceholder else ''}}">
                  {% if isPlaceholder %}
                      <i class="fa-light fa-box-taped"></i>
                  {% else %}
                      <img src="{{image}}" alt="{{product.title}}" loading="lazy" />
                  {% endif %}
              </div>

              <div class="d-flex flex-column">
                  <div class="sellix-customer-table-product-title">{{product.title}}</div>
                  <div class="sellix-customer-table-product-id">{{product.uniqid}}</div>
              </div>
          </div>
          {% if isPayWhatYouWant %}
              <div class="sellix-customer-table-badge">Choose your price</div>
          {% elif isSubscription %}
              <div class="sellix-customer-table-badge">Subscription</div>
          {% endif %}
      </div>
  </td>
  <td>
    {% if productAffiliateRevenue and productAffiliateRevenue > 0 %}
      {{ productAffiliateRevenue }}%
    {% elif productAffiliateRevenue === 0 and shopAffiliateRevenue %}
      {{ shopAffiliateRevenue }}%
    {% elif productAffiliateRevenue -1 and shopAffiliateRevenue %}
      {{ shopAffiliateRevenue }}%
    {% endif %}
  </td>
  <td>
    {% if product.price_discount %}
        {% render_snippet 'Price', currency=product.currency, price=product.price_display, discount=product.price_discount %}
    {% else %}
      <div>
        {% if product.price_variants %}
          <span>Starting at: </span>
        {% endif %}
        {% if isPayWhatYouWant %}
          Choose your price
        {% else %}
          {% render_snippet 'Price', currency=product.currency, price=product.price_display, priceVariants=product.price_variants %}
        {% endif %}
      </div>
    {% endif %}
  </td>
  <td>
    <button type="button" class="medium primary sellix-customer-table-body-copy-link" data-product-id={{ product.uniqid }}>
      <div class="mr-2">
        {% render_snippet 'Copy icon' %}
      </div>
      Copy Link
    </button>
  </td>
</tr>

<script type='application/javascript'>
  $(document).ready(function () {
    $(document).find('.sellix-customer-table-body-copy-link').on('click', el => {
        let id = $(el.currentTarget).data('product-id');
        window.copyToClipboard(`https://${window.location.host}/product/${id}?rcid={{customerRefferalID}}`);
    });
  });
</script>
